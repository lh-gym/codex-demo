name: Codex Auto Merge

on:
  pull_request:
    branches:
      - han/validation          # 只处理合到 han/validation 的 PR
    types: [opened, synchronize, reopened, ready_for_review]

permissions:
  contents: write
  pull-requests: write

jobs:
  automerge:
    runs-on: ubuntu-latest
    steps:
      - name: Auto-merge PR when checks pass
        uses: pascalgn/automerge-action@v0.15.6
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          MERGE_METHOD: squash               # 合并方式：squash
          MERGE_LABELS: ""                   # 不需要特定标签
          MERGE_RETRIES: 24                  # 最多等 24 次
          MERGE_RETRY_SLEEP: 10000           # 每次间隔 10s（单位 ms）
          MERGE_DELETE_BRANCH: true          # 合并后自动删源分支

